<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>README - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#label-Slack-Ruby-Bot">Slack-Ruby-Bot</a>
    <li><a href="#label-Useful+to+Me-3F">Useful to Me?</a>
    <li><a href="#label-Stable+Release">Stable Release</a>
    <li><a href="#label-Usage">Usage</a>
    <li><a href="#label-A+Minimal+Bot">A Minimal Bot</a>
    <li><a href="#label-Gemfile">Gemfile</a>
    <li><a href="#label-pongbot.rb">pongbot.rb</a>
    <li><a href="#label-A+Production+Bot">A Production Bot</a>
    <li><a href="#label-More+Involved+Examples">More Involved Examples</a>
    <li><a href="#label-Commands+and+Operators">Commands and Operators</a>
    <li><a href="#label-Bot+Aliases">Bot Aliases</a>
    <li><a href="#label-Generic+Routing">Generic Routing</a>
    <li><a href="#label-Providing+description+for+your+bot+and+commands">Providing description for your bot and commands</a>
    <li><a href="#label-SlackRubyBot-3A-3ACommands-3A-3ABase">SlackRubyBot::Commands::Base</a>
    <li><a href="#label-say-28channel-3A+...-2C+text-3A+...-2C+gif-3A+...-29">say(channel: …, text: …, gif: …)</a>
    <li><a href="#label-Built-In+Commands">Built-In Commands</a>
    <li><a href="#label-5Bbot+name-5D">[bot name]</a>
    <li><a href="#label-5Bbot+name-5D+hi">[bot name] hi</a>
    <li><a href="#label-5Bbot+name-5D+help">[bot name] help</a>
    <li><a href="#label-Hooks">Hooks</a>
    <li><a href="#label-Implement+and+register+a+Hook+Handler">Implement and register a Hook Handler</a>
    <li><a href="#label-Disable+Animated+GIFs">Disable Animated GIFs</a>
    <li><a href="#label-Message+Loop+Protection">Message Loop Protection</a>
    <li><a href="#label-Logging">Logging</a>
    <li><a href="#label-Advanced+Integration">Advanced Integration</a>
    <li><a href="#label-RSpec+Shared+Behaviors">RSpec Shared Behaviors</a>
    <li><a href="#label-Useful+Libraries">Useful Libraries</a>
    <li><a href="#label-Contributing">Contributing</a>
    <li><a href="#label-Upgrading">Upgrading</a>
    <li><a href="#label-Copyright+and+License">Copyright and License</a>
  </ul>
</div>


  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="./CHANGELOG_md.html">CHANGELOG</a>
  
    <li><a href="./CONTRIBUTING_md.html">CONTRIBUTING</a>
  
    <li><a href="./DEPLOYMENT_md.html">DEPLOYMENT</a>
  
    <li><a href="./Gemfile.html">Gemfile</a>
  
    <li><a href="./LICENSE_md.html">LICENSE</a>
  
    <li><a href="./README_md.html">README</a>
  
    <li><a href="./RELEASING_md.html">RELEASING</a>
  
    <li><a href="./Rakefile.html">Rakefile</a>
  
    <li><a href="./TUTORIAL_md.html">TUTORIAL</a>
  
    <li><a href="./UPGRADING_md.html">UPGRADING</a>
  
    <li><a href="./examples/market/Gemfile.html">Gemfile</a>
  
    <li><a href="./examples/market/Procfile.html">Procfile</a>
  
    <li><a href="./examples/minimal/Gemfile.html">Gemfile</a>
  
    <li><a href="./examples/minimal/Gemfile_lock.html">Gemfile.lock</a>
  
    <li><a href="./examples/minimal/Procfile.html">Procfile</a>
  
    <li><a href="./examples/minimal/google/CHANGELOG_md.html">CHANGELOG</a>
  
    <li><a href="./examples/minimal/google/CONTRIBUTING_md.html">CONTRIBUTING</a>
  
    <li><a href="./examples/minimal/google/DEPLOYMENT_md.html">DEPLOYMENT</a>
  
    <li><a href="./examples/minimal/google/Gemfile.html">Gemfile</a>
  
    <li><a href="./examples/minimal/google/Gemfile_lock.html">Gemfile.lock</a>
  
    <li><a href="./examples/minimal/google/LICENSE_md.html">LICENSE</a>
  
    <li><a href="./examples/minimal/google/Procfile.html">Procfile</a>
  
    <li><a href="./examples/minimal/google/README_md.html">README</a>
  
    <li><a href="./examples/minimal/google/Rakefile.html">Rakefile</a>
  
    <li><a href="./examples/minimal/google/app_json.html">app.json</a>
  
    <li><a href="./examples/minimal/google/config_ru.html">config.ru</a>
  
    <li><a href="./examples/weather/Gemfile.html">Gemfile</a>
  
    <li><a href="./examples/weather/Procfile.html">Procfile</a>
  
    <li><a href="./slack-ruby-bot_gemspec.html">slack-ruby-bot.gemspec</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page README.md">

<h1 id="label-Slack-Ruby-Bot">Slack-Ruby-Bot<span><a href="#label-Slack-Ruby-Bot">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p><a href="http://badge.fury.io/rb/slack-ruby-bot"><img
src="https://badge.fury.io/rb/slack-ruby-bot.svg"></a> <a
href="https://travis-ci.org/dblock/slack-ruby-bot"><img
src="https://travis-ci.org/dblock/slack-ruby-bot.svg"></a> <a
href="https://codeclimate.com/github/dblock/slack-ruby-bot"><img
src="https://codeclimate.com/github/dblock/slack-ruby-bot/badges/gpa.svg"></a></p>

<p>A generic <a href="Slack.html">Slack</a> bot framework written in Ruby on
top of <a
href="https://github.com/dblock/slack-ruby-client">slack-ruby-client</a>.
This library does all the heavy lifting, such as message parsing, so you
can focus on implementing slack bot commands. It also attempts to introduce
the bare minimum number of requirements or any sorts of limitations.
It&#39;s a <a href="Slack.html">Slack</a> bot boilerplate.</p>

<p>If you are not familiar with <a href="Slack.html">Slack</a> bots or <a
href="Slack.html">Slack</a> API concepts, you might want to watch <a
href="http://code.dblock.org/2016/03/11/your-first-slack-bot-service-video.html">this
video</a>.</p>

<p><img src="slack.png"></p>

<h2 id="label-Useful+to+Me-3F">Useful to Me?<span><a href="#label-Useful+to+Me-3F">&para;</a> <a href="#top">&uarr;</a></span></h2>
<ul><li>
<p>If you are just trying to send messages to <a href="Slack.html">Slack</a>,
use <a
href="https://github.com/dblock/slack-ruby-client">slack-ruby-client</a>,
which this library is built on top of.</p>
</li><li>
<p>If you&#39;re trying to roll out a full service with <a
href="Slack.html">Slack</a> button integration, check out <a
href="https://github.com/dblock/slack-bot-server">slack-bot-server</a>,
which uses this library.</p>
</li><li>
<p>Otherwise, this piece of the puzzle will help you create a single bot
instance for one team.</p>
</li></ul>

<h2 id="label-Stable+Release">Stable Release<span><a href="#label-Stable+Release">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>You&#39;re reading the documentation for the <strong>next</strong> release
of slack-ruby-bot. Please see the documentation for the <a
href="https://github.com/dblock/slack-ruby-bot/tree/v0.8.0">last stable
release, v0.8.0</a> unless you&#39;re integrating with HEAD. See <a
href="CHANGELOG.md">CHANGELOG</a> for a history of changes and <a
href="UPGRADING.md">UPGRADING</a> for how to upgrade to more recent
versions.</p>

<h2 id="label-Usage">Usage<span><a href="#label-Usage">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-A+Minimal+Bot">A Minimal <a href="Bot.html">Bot</a><span><a href="#label-A+Minimal+Bot">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-Gemfile"><a href="Gemfile.html">Gemfile</a><span><a href="#label-Gemfile">&para;</a> <a href="#top">&uarr;</a></span></h4>

<pre class="ruby"><span class="ruby-identifier">source</span> <span class="ruby-string">&#39;https://rubygems.org&#39;</span>

<span class="ruby-identifier">gem</span> <span class="ruby-string">&#39;slack-ruby-bot&#39;</span>
<span class="ruby-identifier">gem</span> <span class="ruby-string">&#39;celluloid-io&#39;</span>
</pre>

<h4 id="label-pongbot.rb">pongbot.rb<span><a href="#label-pongbot.rb">&para;</a> <a href="#top">&uarr;</a></span></h4>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;slack-ruby-bot&#39;</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">PongBot</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Bot</span>
  <span class="ruby-identifier">command</span> <span class="ruby-string">&#39;ping&#39;</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">client</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">match</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">client</span>.<span class="ruby-identifier">say</span>(<span class="ruby-identifier">text</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;pong&#39;</span>, <span class="ruby-identifier">channel</span><span class="ruby-operator">:</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">channel</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">PongBot</span>.<span class="ruby-identifier">run</span>
</pre>

<p>After <a href="DEPLOYMENT.md">registering the bot</a>, run with
<code>SLACK_API_TOKEN=... bundle exec ruby pongbot.rb</code>. Have the bot
join a channel and send it a ping.</p>

<p><img src="screenshots/demo.gif"></p>

<h3 id="label-A+Production+Bot">A Production <a href="Bot.html">Bot</a><span><a href="#label-A+Production+Bot">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>A typical production <a href="Slack.html">Slack</a> bot is a combination of
a vanilla web server and a websocket application that talks to the <a
href="Slack.html">Slack</a> Real Time Messaging API. See our <a
href="TUTORIAL.md">Writing a Production Bot</a> tutorial for more
information.</p>

<h3 id="label-More+Involved+Examples">More Involved Examples<span><a href="#label-More+Involved+Examples">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The following examples of bots based on slack-ruby-bot are listed in
growing order of complexity.</p>
<ul><li>
<p><a
href="https://github.com/dblock/slack-bot-on-rails">slack-bot-on-rails</a>:
A bot running on Rails and using React to display <a
href="Slack.html">Slack</a> messages on a website.</p>
</li><li>
<p><a href="https://github.com/dblock/slack-mathbot">slack-mathbot</a>: <a
href="Slack.html">Slack</a> integration with math.</p>
</li><li>
<p><a href="https://github.com/dblock/slack-google-bot">slack-google-bot</a>:
A <a href="Slack.html">Slack</a> bot that searches Google, including CSE.</p>
</li><li>
<p><a href="https://github.com/dblock/slack-aws">slack-aws</a>: <a
href="Slack.html">Slack</a> integration with Amazon Web Services.</p>
</li><li>
<p><a href="https://github.com/dblock/slack-gamebot">slack-gamebot</a>: A game
bot service for ping pong, chess, etc, hosted at <a
href="http://playplay.io">playplay.io</a>.</p>
</li></ul>

<h3 id="label-Commands+and+Operators">Commands and Operators<span><a href="#label-Commands+and+Operators">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Bots are addressed by name, they respond to commands and operators. You can
combine multiple commands.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">CallBot</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Bot</span>
  <span class="ruby-identifier">command</span> <span class="ruby-string">&#39;call&#39;</span>, <span class="ruby-string">&#39;呼び出し&#39;</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">client</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">match</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">client</span>.<span class="ruby-identifier">say</span>(<span class="ruby-identifier">channel</span><span class="ruby-operator">:</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">channel</span>, <span class="ruby-identifier">text</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;called&#39;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Command match data includes <code>match['bot']</code>,
<code>match['command']</code> and <code>match['expression']</code>. The
<code>bot</code> match always checks against the
<code>SlackRubyBot::Config.user</code> and
<code>SlackRubyBot::Config.user_id</code> values obtained when the bot
starts.</p>

<p>Operators are 1-letter long and are similar to commands. They don&#39;t
require addressing a bot nor separating an operator from its arguments. The
following class responds to <code>=2+2</code>.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">MathBot</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Bot</span>
  <span class="ruby-identifier">operator</span> <span class="ruby-string">&#39;=&#39;</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">client</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">match</span><span class="ruby-operator">|</span>
    <span class="ruby-comment"># implementation detail</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Operator match data includes <code>match['operator']</code> and
<code>match['expression']</code>. The <code>bot</code> match always checks
against the <code>SlackRubyBot::Config.user</code> setting.</p>

<h3 id="label-Bot+Aliases"><a href="Bot.html">Bot</a> Aliases<span><a href="#label-Bot+Aliases">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>A bot will always respond to its name (eg. <code>rubybot</code>) and <a
href="Slack.html">Slack</a> ID (eg. <code>@rubybot</code>), but you can
specify multiple aliases via the <code>SLACK_RUBY_BOT_ALIASES</code>
environment variable or via an explicit configuration.</p>

<pre>SLACK_RUBY_BOT_ALIASES=:pp: table-tennis</pre>

<pre class="ruby"><span class="ruby-constant">SlackRubyBot</span>.<span class="ruby-identifier">configure</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">config</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">config</span>.<span class="ruby-identifier">aliases</span> = [<span class="ruby-string">&#39;:pong:&#39;</span>, <span class="ruby-string">&#39;pongbot&#39;</span>]
<span class="ruby-keyword">end</span>
</pre>

<p>This is particularly fun with emoji.</p>

<p><img src="screenshots/aliases.gif"></p>

<p>Bots also will respond to a direct message, with or without the bot name in
the message itself.</p>

<p><img src="screenshots/dms.gif"></p>

<h3 id="label-Generic+Routing">Generic Routing<span><a href="#label-Generic+Routing">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Commands and operators are generic versions of bot routes. You can respond
to just about anything by defining a custom route.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Weather</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Bot</span>
  <span class="ruby-identifier">match</span> <span class="ruby-regexp">/^How is the weather in (?&lt;location&gt;\w*)\?$/</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">client</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">match</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">client</span>.<span class="ruby-identifier">say</span>(<span class="ruby-identifier">channel</span><span class="ruby-operator">:</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">channel</span>, <span class="ruby-identifier">text</span><span class="ruby-operator">:</span> <span class="ruby-node">&quot;The weather in #{match[:location]} is nice.&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p><img src="screenshots/weather.gif"></p>

<p>You can also capture multiple matchers with <code>scan</code>.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Market</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Bot</span>
  <span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/(\[A-Z]{2,5})/</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">client</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">stocks</span><span class="ruby-operator">|</span>
    <span class="ruby-comment"># lookup stock market price</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p><img src="screenshots/market.gif"></p>

<p>See <a href="examples/market/marketbot.rb">examples/market</a> for a
working example.</p>

<h3 id="label-Providing+description+for+your+bot+and+commands">Providing description for your bot and commands<span><a href="#label-Providing+description+for+your+bot+and+commands">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>You can specify help information for bot or commands with <code>help</code>
block, for example:</p>

<p>in case of bot:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">WeatherBot</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Bot</span>
  <span class="ruby-identifier">help</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">title</span> <span class="ruby-string">&#39;Weather Bot&#39;</span>
    <span class="ruby-identifier">desc</span> <span class="ruby-string">&#39;This bot tells you the weather.&#39;</span>

    <span class="ruby-identifier">command</span> <span class="ruby-string">&#39;clouds&#39;</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">desc</span> <span class="ruby-string">&#39;Tells you how many clouds there\re above you.&#39;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">command</span> <span class="ruby-string">&#39;What\s the weather in &lt;city&gt;?&#39;</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">desc</span> <span class="ruby-string">&#39;Tells you the weather in a &lt;city&gt;.&#39;</span>
      <span class="ruby-identifier">long_desc</span> <span class="ruby-string">&quot;Accurate 10 Day Weather Forecasts for thousands of places around the World.\n&quot;</span>          <span class="ruby-string">&#39;Bot provides detailed Weather Forecasts over a 10 day period updated four times a day.&#39;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># commands implementation</span>
<span class="ruby-keyword">end</span>
</pre>

<p><img src="screenshots/help-command-examples.png"></p>

<p>in case of your own command:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Deploy</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Commands</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">help</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">title</span> <span class="ruby-string">&#39;deploy&#39;</span>
    <span class="ruby-identifier">desc</span> <span class="ruby-string">&#39;deploys your app&#39;</span>
    <span class="ruby-identifier">long_desc</span> <span class="ruby-string">&#39;command format: *deploy &lt;branch&gt; to &lt;env&gt;* where &lt;env&gt; is production or staging&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<h3 id="label-SlackRubyBot-3A-3ACommands-3A-3ABase"><a href="SlackRubyBot/Commands/Base.html">SlackRubyBot::Commands::Base</a><span><a href="#label-SlackRubyBot-3A-3ACommands-3A-3ABase">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The <code>SlackRubyBot::Bot</code> class is DSL sugar deriving from
<code>SlackRubyBot::Commands::Base</code>. For more involved bots you can
organize the bot implementation into subclasses of
<code>SlackRubyBot::Commands::Base</code> manually. By default a command
class responds, case-insensitively, to its name. A class called
<code>Phone</code> that inherits from
<code>SlackRubyBot::Commands::Base</code> responds to <code>phone</code>
and <code>Phone</code> and calls the <code>call</code> method when
implemented.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Phone</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Commands</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">command</span> <span class="ruby-string">&#39;call&#39;</span>

  <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">client</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">match</span>)
    <span class="ruby-identifier">client</span>.<span class="ruby-identifier">say</span>(<span class="ruby-identifier">channel</span><span class="ruby-operator">:</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">channel</span>, <span class="ruby-identifier">text</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;called&#39;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>To respond to custom commands and to disable automatic class name matching,
use the <code>command</code> keyword. The following command responds to
<code>call</code> and <code>呼び出し</code> (call in Japanese).</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Phone</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Commands</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">command</span> <span class="ruby-string">&#39;call&#39;</span>
  <span class="ruby-identifier">command</span> <span class="ruby-string">&#39;呼び出し&#39;</span>

  <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">client</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">match</span>)
    <span class="ruby-identifier">client</span>.<span class="ruby-identifier">say</span>(<span class="ruby-identifier">channel</span><span class="ruby-operator">:</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">channel</span>, <span class="ruby-identifier">text</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;called&#39;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The <code>SlackRubyBot::Client</code> implementation comes with GIF
support.</p>

<h4 id="label-say-28channel-3A+...-2C+text-3A+...-2C+gif-3A+...-29">say(channel: …, text: …, gif: …)<span><a href="#label-say-28channel-3A+...-2C+text-3A+...-2C+gif-3A+...-29">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Sends text and/or a random GIF that matches a keyword using a RealTime
client to a channel.</p>

<h3 id="label-Built-In+Commands">Built-In Commands<span><a href="#label-Built-In+Commands">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Slack-ruby-bot comes with several built-in commands. You can re-define
built-in commands, normally, as described above.</p>

<h4 id="label-5Bbot+name-5D">[bot name]<span><a href="#label-5Bbot+name-5D">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>This is also known as the <code>default</code> command. Shows bot version
and links.</p>

<h4 id="label-5Bbot+name-5D+hi">[bot name] hi<span><a href="#label-5Bbot+name-5D+hi">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Politely says &#39;hi&#39; back.</p>

<h4 id="label-5Bbot+name-5D+help">[bot name] help<span><a href="#label-5Bbot+name-5D+help">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Get help.</p>

<h3 id="label-Hooks">Hooks<span><a href="#label-Hooks">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Hooks are event handlers and respond to <a href="Slack.html">Slack</a> RTM
API <a href="https://api.slack.com/events">events</a>, such as <a
href="lib/slack-ruby-bot/hooks/hello.rb">hello</a> or <a
href="lib/slack-ruby-bot/hooks/message.rb">message</a>. You can implement
your own in a couple of ways:</p>

<h4 id="label-Implement+and+register+a+Hook+Handler">Implement and register a Hook Handler<span><a href="#label-Implement+and+register+a+Hook+Handler">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>A Hook Handler is any object that respond to a <code>call</code> message,
like a proc, instance of an object, class with a <code>call</code> class
method, etc.</p>

<p>Hooks are registered onto the <code>SlackRubyBot::Server</code> instance,
by way of a configuration hash</p>

<pre class="ruby"><span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Server</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">hook_handlers</span><span class="ruby-operator">:</span> {
  <span class="ruby-identifier">hello</span><span class="ruby-operator">:</span> <span class="ruby-constant">MyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Hooks</span><span class="ruby-operator">::</span><span class="ruby-constant">UserChange</span>.<span class="ruby-identifier">new</span>
})
</pre>

<p>or at any time by pushing it to the <code>HookSet</code></p>

<pre class="ruby"><span class="ruby-comment"># Push an object that implements the</span>
<span class="ruby-identifier">server</span>.<span class="ruby-identifier">hooks</span>.<span class="ruby-identifier">add</span>(:<span class="ruby-identifier">hello</span>, <span class="ruby-constant">MyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Hooks</span><span class="ruby-operator">::</span><span class="ruby-constant">UserChange</span>.<span class="ruby-identifier">new</span>)

<span class="ruby-comment"># Push a lambda to handle the event</span>
<span class="ruby-identifier">server</span>.<span class="ruby-identifier">hooks</span>.<span class="ruby-identifier">add</span>(:<span class="ruby-identifier">hello</span>, <span class="ruby-operator">-</span><span class="ruby-operator">&gt;</span>(<span class="ruby-identifier">client</span>, <span class="ruby-identifier">data</span>) { <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Hello!&quot;</span> })
</pre>

<p>For example, the following hook handles <a
href="https://api.slack.com/events/user_change">user_change</a>, an event
sent when a team member updates their profile or data. This can be useful
to update the local user cache when a user is renamed.</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">MyBot</span>
  <span class="ruby-keyword">module</span> <span class="ruby-constant">Hooks</span>
    <span class="ruby-keyword">class</span> <span class="ruby-constant">UserChange</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier">call</span>(<span class="ruby-identifier">client</span>, <span class="ruby-identifier">data</span>)
        <span class="ruby-comment"># data[&#39;user&#39;][&#39;id&#39;] contains the user ID</span>
        <span class="ruby-comment"># data[&#39;user&#39;][&#39;name&#39;] contains the new user name</span>
        <span class="ruby-operator">...</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Hooks can also be written as blocks inside the
<code>SlackBotRuby::Server</code> class, for example</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">MyBot</span>
  <span class="ruby-keyword">class</span> <span class="ruby-constant">MyServer</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Server</span>
    <span class="ruby-identifier">on</span> <span class="ruby-string">&#39;hello&#39;</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">client</span>, <span class="ruby-identifier">data</span><span class="ruby-operator">|</span>
      <span class="ruby-comment"># data[&#39;user&#39;][&#39;id&#39;] contains the user ID</span>
      <span class="ruby-comment"># data[&#39;user&#39;][&#39;name&#39;] contains the new user name</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>These will get pushed into the hook set on initialization.</p>

<p>Either by configuration, explicit assignment or hook blocks, multiple
handlers can exist for the same event type.</p>

<h3 id="label-Disable+Animated+GIFs">Disable Animated GIFs<span><a href="#label-Disable+Animated+GIFs">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>By default bots send animated GIFs in default commands and errors. To
disable animated GIFs set <code>send_gifs</code> or
<code>ENV['SLACK_RUBY_BOT_SEND_GIFS']</code> to <code>false</code>.</p>

<pre class="ruby"><span class="ruby-constant">SlackRubyBot</span>.<span class="ruby-identifier">configure</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">config</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">config</span>.<span class="ruby-identifier">send_gifs</span> = <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span>
</pre>

<h3 id="label-Message+Loop+Protection">Message Loop Protection<span><a href="#label-Message+Loop+Protection">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>By default bots do not respond to their own messages. If you wish to change
that behavior, set <code>allow_message_loops</code> to <code>true</code>.</p>

<pre class="ruby"><span class="ruby-constant">SlackRubyBot</span>.<span class="ruby-identifier">configure</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">config</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">config</span>.<span class="ruby-identifier">allow_message_loops</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span>
</pre>

<h3 id="label-Logging">Logging<span><a href="#label-Logging">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>By default bots set a logger to <code>STDOUT</code> with <code>DEBUG</code>
level. The logger is used in both the RealTime and Web clients. Silence
logger as follows.</p>

<pre class="ruby"><span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span>.<span class="ruby-identifier">logger</span>.<span class="ruby-identifier">level</span> = <span class="ruby-constant">Logger</span><span class="ruby-operator">::</span><span class="ruby-constant">WARN</span>
</pre>

<h3 id="label-Advanced+Integration">Advanced Integration<span><a href="#label-Advanced+Integration">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>You may want to integrate a bot or multiple bots into other systems, in
which case a globally configured bot may not work for you. You may create
instances of <a
href="lib/slack-ruby-bot/server.rb">SlackRubyBot::Server</a> which accepts
<code>token</code>, <code>aliases</code> and <code>send_gifs</code>.</p>

<pre class="ruby"><span class="ruby-constant">EM</span>.<span class="ruby-identifier">run</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">bot1</span> = <span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Server</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">token1</span>, <span class="ruby-identifier">aliases</span><span class="ruby-operator">:</span> [<span class="ruby-string">&#39;bot1&#39;</span>])
  <span class="ruby-identifier">bot1</span>.<span class="ruby-identifier">start_async</span>

  <span class="ruby-identifier">bot2</span> = <span class="ruby-constant">SlackRubyBot</span><span class="ruby-operator">::</span><span class="ruby-constant">Server</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">token2</span>, <span class="ruby-identifier">send_gifs</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>, <span class="ruby-identifier">aliases</span><span class="ruby-operator">:</span> [<span class="ruby-string">&#39;bot2&#39;</span>])
  <span class="ruby-identifier">bot2</span>.<span class="ruby-identifier">start_async</span>
<span class="ruby-keyword">end</span>
</pre>

<p>For an example of advanced integration that supports multiple teams, see <a
href="https://github.com/dblock/slack-gamebot">slack-gamebot</a> and <a
href="http://playplay.io">playplay.io</a> that is built on top of it.</p>

<h3 id="label-RSpec+Shared+Behaviors"><a href="RSpec.html">RSpec</a> Shared Behaviors<span><a href="#label-RSpec+Shared+Behaviors">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Slack-ruby-bot ships with a number of shared <a href="RSpec.html">RSpec</a>
behaviors that can be used in your <a href="RSpec.html">RSpec</a> tests.
Require &#39;slack-ruby-bot/rspec&#39; in your <code>spec_helper.rb</code>.</p>
<ul><li>
<p><a
href="lib/slack-ruby-bot/rspec/support/slack-ruby-bot/it_behaves_like_a_slack_bot.rb">behaves
like a slack bot</a>: A bot quacks like a <a href="Slack.html">Slack</a>
Ruby bot.</p>
</li><li>
<p><a
href="lib/slack-ruby-bot/rspec/support/slack-ruby-bot/respond_with_slack_message.rb">respond
with slack message</a>: The bot responds with a message.</p>
</li><li>
<p><a
href="lib/slack-ruby-bot/rspec/support/slack-ruby-bot/respond_with_error.rb">respond
with error</a>: An exception is raised inside a bot command.</p>
</li></ul>

<h3 id="label-Useful+Libraries">Useful Libraries<span><a href="#label-Useful+Libraries">&para;</a> <a href="#top">&uarr;</a></span></h3>
<ul><li>
<p><a
href="https://github.com/dblock/newrelic-slack-ruby-bot">newrelic-slack-ruby-bot</a>:
NewRelic instrumentation for slack-ruby-bot.</p>
</li></ul>

<h2 id="label-Contributing">Contributing<span><a href="#label-Contributing">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>See <a href="CONTRIBUTING.md">CONTRIBUTING</a>.</p>

<h2 id="label-Upgrading">Upgrading<span><a href="#label-Upgrading">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>See <a href="CHANGELOG.md">CHANGELOG</a> for a history of changes and <a
href="UPGRADING.md">UPGRADING</a> for how to upgrade to more recent
versions.</p>

<h2 id="label-Copyright+and+License">Copyright and License<span><a href="#label-Copyright+and+License">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Copyright © 2015-2016, <a href="https://twitter.com/dblockdotorg">Daniel
Doubrovkine</a>, <a href="https://www.artsy.net">Artsy</a> and <a
href="CHANGELOG.md">Contributors</a>.</p>

<p>This project is licensed under the <a href="LICENSE.md">MIT License</a>.</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

